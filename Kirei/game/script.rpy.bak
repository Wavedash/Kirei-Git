# Here's the splash screen that goes before the main menu.
label splashscreen:

    #This variable controls what version we're running. For android versions, set to True.
    #This will disable anything that the android version of Ren'Py can't handle
    #such as text input, and replace it with something else.

    scene black
    if config.developer:
        show nanologo at truecenter
        show text "{font=assets/engine/AndBasR.ttf}\n\nDEVELOPER MODE IS ACTIVE{/font}"
        with dissolve
        
        $ renpy.pause(3.0)
        
        hide text
        hide nanologo
        with dissolve
        
    if not config.developer:
        show nanologo at truecenter with dissolve 
        $ renpy.pause(3.0)
        hide nanologo with dissolve        
    
    scene bg mainmenu
    with dissolve
    
    return
    
# The game starts here.
label start:
    play sound "assets/sfx/ohdearscare.mp3"
    if config.developer:
        show bg mainmenu
        menu:
            "Start Game":
                jump prologue
            "Chapter Select":
                jump chapterSelect
            "Engine Test":
                jump engineTest
            "CG Test":
                jump CGTest
    if not config.developer:
        jump prologue
    return

label CGTest:
    stop music
    scene black
    $ kirei = "???"
    $ protag = "Akira"
    $ protagchan = "Aki"
    
    play ambience "assets/music/PrologueEpilogue.mp3" fadein 4
    
    k "[protag]..."
    
    k "Wake up..."

    "Man. I can't move."
    
    "There’s something on top of me."

    "Someone..."

    mc "Kirei?"

    play sound "assets/sfx/cackle.mp3"
    
    "A laugh."

    "My neck feels wet..."

    "And my back feels drenched."
    
    $ heartbeat()

    "My heart’s pumping so fast."

    "And it’s cold.{w=.5} I feel so cold."

    "I need to open my eyes."
    
    play music "assets/music/Hungry.mp3" fadein 4

    with dissolve
    scene bg kireiCG:
        pos (0.0, getY(-265))
        linear 10 pos (0.0, 0.0)
    with dissolve

    $ kirei = "Kirei ?!?"
    
    k "Oh, wonderful! You’re still with me!"
    
    mc "Kirei? Is that..?"

    "She's covered in blood!"
    
    $ heartbeat()

    "A shot of pain courses through my body as she brings a hand to my neck."

    "She brings her hand back up in front of my face."
    
    $ double_vision_on("bg kireiCG")

    "It’s stained a dark red."

    k "You're surprisingly concious right now."
    
    k "I won't act like I'm not impressed. You've lost a lot of blood, after all."
    
    $ double_vision_off()

    "I’m bleeding?"

    "She... she bit me!"

    "And I'm gonna die."

    "Oh my god, I'm gonna die!"

    "Please... please, no."

    "Not like this..."
    
    $ kirei = "Kirei"

    k "What's the matter, [protagchan]?"
    
    k "That's an awful mark on your neck."
    
    mc "You..."
    
    k "Shall I kiss it and make it better?"
    
    show bg BGkireiCG with dissolve
    
    play sound "assets/sfx/spiritbreath.mp3"
    play sound2 "assets/sfx/heartbeat.mp3"
    
    show bg blank
    with dissolve
    
    "Kirei puts her mouth on my neck and sucks gently."
    
    show bg BGkireiCG with dissolve
    
    play sound2 "assets/sfx/heartbeat.mp3"
   
    scene bg kireiCG:
        linear 0 pos (0.0,0.0)
    with dissolve
    
    $ double_vision_on("bg kireiCG")
    
    k "Mmm…"

    "I feel..."

    k "Oh, my poor [protagchan]."

    k "You’re such a fool."
    
    $ double_vision_off()
    
    k "But at least you found your vampire. You can take comfort in knowing that you're not crazy."

    k "You."
    
    k "Right in the palm of my hands."

    k "Like putty."

    k "And you fell for it."
    
    $ heartbeat()

    $ double_vision_on("bg kireiCG")
    
    "Vampires?"

    "I thought she was human."
    "She was! She had to be!"
    
    mc "What about...{w=.5} you said before...{w=.5} about a person's soul..."
    
    $ double_vision_off()
    
    play sound "assets/sfx/cackle.mp3"
    
    k "A soul.{w=.5} HA!"
    k "Lot of good that did you."
    k "What's so great about a damn soul?"
    
    "No..."
    
    mc "But what about..."
    mc "Do you even have a..."
    
    $ heartbeat()
    show bg kireiCG:
        pos (0.0, 0.0)
        linear 1 pos (0.0, getY(-265))
    with None
    show black
    with dissolve
    
    $ renpy.pause(3)
   
    k "Do I have a soul? Of course I do."
    k "At least I think I do..."
    
    play sound2 "assets/sfx/heartbeat.mp3"
    
    "She grabs my hair and pulls my head up."
    
    scene bg kireiCG:
        pos (0.0, getY(-265))
        linear 3 pos (0.0, 0.0)
    with dissolve
    
    k "But when you look at it from my point of view..."
    k "It's just so much more fun to give in."

    k "Human feelings? Vampire instinct?"
    play sound2 "assets/sfx/heartbeat.mp3"
    k "What’s the difference?"
    k "We’re all just acting on our desires...{w=.5} for our own selfish reasons."
    k "It’s nothing personal, [protagchan]."
    k "And here I thought maybe you'd be the one to show me some real fun."
    play sound2 "assets/sfx/heartbeat.mp3"

    "She shrugs."

    k "I guess not."
    
    $ double_vision_on("bg kireiCG")
    
    k "You’re just like everyone else."
    
    
    play ambience2 "assets/sfx/heartbeat.mp3"

    "I… I can’t move."
    "I can’t get her off me."
    
    "I can feel my back getting wetter and wetter with my blood."
    "This is how it ends, huh?"
    
    show blank with dissolve
    hide blank with dissolve

    k "Oh, and [protag]?"
    k "Can I ask you a question?"
    
    show blank with dissolve
    $ renpy.pause(1)
    hide blank with dissolve
    
    k "Just one last exchange before you have to go?"
    k "Why did you decide to spend time with me in the first place?"

    "Wh-what?"

    k "Is it because you think I’m pretty?"
    k "You said you wouldn’t mind me taking a bite out of you…"
    k "If I were pretty enough."
    
    $ double_vision_off()
    
    stop music fadeout 3
    
    k "[protagchan].{w=.5}.{w=.5}.{w=.5}.{w=.5}.{w=.5}.{w=.5}. {w=2} am I pretty enough for you?"
    
    scene black
    
    play vocal "assets/sfx/finalbite.mp3"
    play sound "assets/sfx/cackle.mp3"
    #play sound2 "assets/sfx/spiritbreath.mp3"
    stop ambience2
    stop ambience fadeout 3
    
    $ renpy.pause(8)
    
    jump credits1
    
label credits1:
    show text "NaNoRenO Last Minute Challenge"
    
    jump epilogue
    
label credits2:

    return

label engineTest:

    $ protag = "You"
    $ Kirei = "???"
    $ tomo = "???"
    $ protagchan = protag
    
    play sound "assets/sfx/ohdearscare.mp3"
    stop music fadeout 3
    show bg park with dissolve
    
    $ renpy.pause(3)
    
    play music "assets/music/prologue_placeholder.mp3" fadein 4
    
    $ renpy.pause(3)
    
    show tomo hip happy night with dissolve
    
    Tomo "I'm too late."
    Tomo "There's blood. So much blood."
    Tomo "This was… your blood."
    tTomo "No…"
    Tomo "The creature turns around."
    Tomo "Shit. She heard me."
    show Kirei special shadows at offscreenright
    show Kirei at right with move
    play sound "assets/sfx/sharpBreath.mp3"
    #show bg park with vpunch
    show tomo worry night at left with move
    tTomo "Ah!"
    kTomo "{font=assets/engine/Rujis.ttf}I see you finally decided to show your face again.{/font}"
    tTomo "…"
    kTomo "{font=assets/engine/Rujis.ttf}What's the matter? You were never the quiet one before.{/font}"
    tTomo "You…"
    Tomo "My blood begins to boil."
    play sound "assets/sfx/heartbeat.mp3"
    show bg heartbeat
    show bg park with dissolve
    tTomo "You took… From me…"
    kTomo "{font=assets/engine/Rujis.ttf}Oh my. I'm sorry. Was this yours?{/font}"
    kTomo "{font=assets/engine/Rujis.ttf}I didn't realize it had your name on it.{/font}"
    Tomo "Everything is wrong."
    
    play sound "assets/sfx/heartbeat.mp3"
    show bg heartbeat
    show bg park with dissolve
    
    kTomo "{font=assets/engine/Rujis.ttf}A pretty girl like you doesn't need someone like that anyway.{/font}"
    Tomo "Everything…"
    
    play sound "assets/sfx/heartbeat.mp3"
    show bg heartbeat
    show bg park with dissolve
    
    Tomo "Everything is…"
    
    show bg blank
    hide Kirei
    hide tomo
    with dissolve
    
    $ renpy.pause(2.0)
    
    show text "{font=assets/engine/AndBasR.ttf}(not) zap apple project presents{/font}" with dissolve
    
    $ renpy.pause(3.0)
    
    hide text with dissolve
    show text "{font=assets/engine/AndBasR.ttf}a NaNoRenO 2014 novella{/font}" with dissolve
    
    $ renpy.pause(3.0)
    
    hide text with dissolve
    
    $ renpy.pause(1.5)
    
    #Sound effect for title appearing
    #play sound "assets/sfx/spiritbreath.mp3"
    
    $ renpy.pause(0.5)
    
    show title at truecenter with dissolve
    
    $ renpy.pause(3.0)
    
    hide title with dissolve
    
    stop music fadeout 4.0
    
    $ renpy.pause(4.0)
    
    play sound "assets/sfx/schoolbell.mp3"
    show bg classroom
    with eyeopen
    $ renpy.pause(3.0)
    play music "assets/music/definitelynotchattingwithvampires.mp3"
    
    "Whoops."
    "Must've dozed off for a minute there."
    "Students are getting up and making their way to the door."
    "I stretch."
    "I hope the teacher didn't notice th-{nw}"
    
    play sound "assets/sfx/thud.mp3"
    show bg classroom
    with vpunch
    
    k "Hey."
    
    show Kirei arm smile
    with dissolve
    
    "One of the more popular girls in class stands in front of me."
    "She had dropped her books on my desk."
    mc "Oh. Uh, hey."
    "She looks really excited."
    k "I was wondering if you-"
    "She strains like she's trying to remember something."
    k "…"
    k "I'm sorry. I can never remember your name."
    "Of course. I can't imagine she'd know it."
    
    $ protag = ""
    
    $ protag = renpy.input("\nIt's…", "Akira", length=20)


    
    if not protag:
        $ protag = "Akira"
    
    if protag == "Akira":
        $ protagchan = "Aki"
    if protag != "Akira":
        $ protagchan = protag
    
    mc "It's [protag]."
    mc "You're Kirei, right?"
        
    k "Right. I'm sorry. I'm not very good with names at all."
    k "[protag]. I won't forget it."
    "But why would she be talking to me?"
    
    show bg classroom_grey
    with dissolve
    
    "[Kirei] has always been a part of the more \"popular\" crowd."
    "She tends to hang out with people way above my rung on the social ladder."
    "I think she may be the top student in class, as well."

    "Maybe she needs to borrow a pencil or something."
    show bg classroom
    with dissolve
    
    k "You’re into that paranormal stuff, right?"
    k "Like ghosts and zombies and junk?"
    "Oh."
    "I guess my reputation as a crazy bigfoot-chaser hasn't changed."
    "It's not like I read about it all the time. I brought a magazine to school once and it fell out in the hallway."
    "I don't think I'll ever live that down."
    "But even so, if Kirei is interested in it…"
    "I should at least hear her out."
    "It's not like pretty girls generally give me the time of day."
    mc "I guess. Why do you ask?"
    k "Oh good!"
    k "You see, I'm sorta interested in that kind of thing, especially with the rumors going around lately."
    k "Have you heard about the vampire sightings over the past couple of months?"
    "I heard a little about it. Vampires really aren't my thing. I don't know much about them."
    t "Oh please."
    show Kirei smile at right with move
    show tomo happy at left with dissolve
    t "What a load of nonsense."
    $ tomo = "[tomo]"
    if  protag == tomo:
        $ tomo = "Mashiro"
    mc "Hey, [tomo]."
    t "Hey yourself, [protagchan]."
    "She glances at [Kirei]."
    t "Who're you?"
    
    # show bg classroom evening
    # show tomo happy evening at left
    # show Kirei smile arm evening at right
    # with dissolve
    
    # "Oh wow. How'd it get so late?"
    
    # hide tomo
    # hide Kirei
    
    # show bg blank
    
    # show tomo happy hip  at left
    # show tomo2 smile hip evening
    # show tomo3 smile hip night at right
    
    # "Left, afternoon. | Center, evening. | Right, night."
    
    stop music fadeout 0.5
    
    hide Kirei
    hide tomo
    show bg blank
    with dissolve
    
    $ renpy.pause(3.0)
    
    show bg mainmenu with dissolve
    
    return

label chapterSelect:

    scene black
    $ protag = "Akira"
    $ Kirei = "Kirei"
    $ tomo = "Tomo"
    
    menu:
        "day1_school":
            $ protag = "You"
            $ kirei = "???"
            jump day1_school
        "day1_afterschool":
            jump day1_afterschool
    return
    
label prologue:
    stop music fadeout 4
    show bg mainmenu
    scene bg park night 
    with dissolve
    
    $ renpy.pause(2)
    play ambience "assets/sfx/night.mp3" fadein 4
    play music "assets/music/PrologueEpilogue.mp3" fadein 4
    
    $ renpy.pause(2)
    
    # show tomo worry night at left with dissolve
    
    Tomo "Where are they?"
    
    Tomo "I race towards the tree line."
    
    show kirei special shadows with quickdissolve
    play sound "assets/sfx/sharpBreath.mp3"
    show bg park night
    with vpunch
    
    Tomo "Freezing in my tracks, I spot them."
    
    Tomo "I’m...{w=.5} I'm too late."
 
    play sound "assets/sfx/cackle.mp3"
 
    Tomo "The creature laughs loudly as it takes a bite."
    
    play vocal "assets/sfx/chewing.mp3"
   
   #$ double_vision_on("bg park night")
    
    Tomo "I can’t watch this."

    Tomo "There’s so much blood."
    
    $ heartbeat()

    Tomo "I should have paid more attention."
    
    $ heartbeat()

    Tomo "I...{w=.5} I could have done something."
    
    #$ double_vision_off()
    
    stop ambience fadeout(2)
    scene black
    with dissolve
    
    Tomo "I could have stopped this."
    
    stop vocal fadeout 5
    
    jump titleSequence
    
label titleSequence:

    if config.developer == False:
        $ overriding_on = True
    
    $ renpy.pause(2.0)
    
    show text "{font=assets/engine/AndBasR.ttf}(not) zap apple project presents{/font}" with dissolve
    
    $ renpy.pause(3.0)
    
    hide text with dissolve
    
    show text "{font=assets/engine/AndBasR.ttf}a nanoreno 2014 \"last minute challenge\"{/font}" with dissolve
    
    $ renpy.pause(3.0)
    
    hide text with dissolve
    
    $ renpy.pause(1.5)
    
    $ renpy.pause(0.5)

    show title at truecenter with dissolve
    
    $ renpy.pause(3.0)
    
    hide title with dissolve
    
    stop music fadeout 3
    
    $ renpy.pause(5.0)

    jump day1_school
    
label day1_school:
    
    $ protag = "You"
    $ kirei = "???"
    $ tomo = "Tomo"
    
    play sound "assets/sfx/schoolbell.mp3"
    scene bg classroom
    with eyeopen
    play music "assets/music/HangingOut.mp3"
    $ renpy.pause(2.0)

    if config.developer == False:
        $ overriding_on = False
        $ renpy.block_rollback()
    
    "The bell rings loudly in my ear."
    "Where am I?"
    "Oh."
    "I must’ve dozed off."
    "I stretch."
    "Math has always been boring, but sometimes the teacher can just drone on forever."
    "What’s the point of giving a lecture on precalc, anyway?"
    
    "I let out an unintentionally loud yawn."
    "A stifled giggle floats from across the room."
    
    show tomo hip happy
    with dissolve
    
    "I'd recognize that laugh anywhere."

    show bg classroom grey
    with dissolve

    "Tomo. I’ve known her since we were freshman." 
    "She’s been my friend since we started high school."
    "We don’t have much in common, but for some reason, we really click."
    "It's lucky for me. I don’t make friends well."
    "Lately, we’ve been spending a lot of time together."
    "More than usual since the beginning of our last semester."
    "Guess it all falls into place when your schedules are exactly the same."
    "As a matter of fact, we have the next class together, too."

    show kirei arm happy with dissolve
    hide tomo with dissolve

    k "Hey, you!"

    "My view is suddenly obstructed."

    "I look up and recognize her face but a name doesn’t immediately come to mind."

    "She’s one of the popular girls on campus. Definitely not on my level of social class." 
    "Why is she talking to me?"
    "She looks excited."

    k "Hey, you okay there?"

    play sound "assets/sfx/thud.mp3"
    show bg classroom with vpunch

    "She drops her books on my desk to capture my attention."

    mc "Huh? Uh… yeah, I’m fine."

    k "Can I ask you a question?"

    "She taps her fingers together and looks me in the eye."

    k "You’re into that paranormal stuff, right? "
    k "Like ghosts and zombies and all that?"

    "I nod slowly."
    "Last week, I brought one of my hunter magazines to class."
    "\"Hunter,\" as in ghost hunter."
    "It fell out of my bag in class and I've gotten hell for it ever since."
    "It’s not like I’m addicted to the stuff. I just…{w=.5} dabble."
    "But I suppose if someone like her wants to talk about it, I wouldn’t mind so much…"

    k "Oh, I can’t believe I’ve forgotten your name…"

    "I wonder if she knew it in the first place."
    "She sighs and pokes her cheek."
    "Oh well. I didn’t expect her to know it anyway."

    # name entry junk
    
    $ protag = ""
    
    $ protag = renpy.input("\nIt's…", "Akira", length=20)

    if not protag:
        $ protag = "Akira"
 
    if protag == "Akira":
        $ protagchan = "Aki"
    if protag != "Akira":
        $ protagchan = protag

    mc "It's [protag]."

    k "Right! [protag]! I won’t forget it."

    "She smiles excitedly."

    mc "And you’re Kirei, right?"
    
    $ kirei = "Kirei"

    "Yeah, that’s her name. Most everyone in school knows it."
    "She nods and reaches her hand out to me."
    "What is this girl even after? My vote for class president?"
    "No. That wouldn't make sense. We’ve only got a few months of school left."
    
    play sound "assets/sfx/heartbeat.mp3"
    
    "As I grab her hand to shake, she squeezes mine and giggles."

    k "So… have you heard about the recent vampire sightings?"

    mc "Vampires, huh? Never really piqued my interest."

    "Of course, typical for a girl to be interested in vampires."
    "Probably some skewed fantasy of romance and drama."
    # "I’m sure she doesn’t actually know the gruesome details."
    "But of course I’ve heard about the sightings."

    mc "I read it on a blog{nw}" # {nw} makes the game move to the next line of text right away without waiting.
    mc "Er... The news. I saw it on the news."

    "Smooth, [protag]. Just show her how much of a dork you are. Blog? Really?"

    mc "They were talking about how there had been strange sightings in the area before the murders."
    mc "Bats, and strange shadows. Shady figures and pale skin."
    mc "And the victims…"

    k "Isn’t that just fascinating?"

    mc "…"

    "Who is this girl again?"
    "\"Little miss popular\" Kirei? \"Loved and adored by the entire student body\" Kirei?"
    "I guess even the normal ones have their dark secrets. "
    "And I guess it’s pretty cool that it’s coming from Kirei."
    "Most girls like her would never give me the time of day."

    k "Do you wanna hang out with me after class today? I’ve got something I’d like to show you."

    "Show me what?"
    "Is this even happening right now?"
    "I’ve seen her around almost all year, but…"
    "She’s actually talking to me."

    mc "I’ve got nothing else to do today."
    
    "Goddammit. Should have gone with, \"Oh. I'd love to, Akira\". What is wrong with me?"

    k "Great. Text me after school lets out?"

    "She grins softly and slides me a sheet of paper."
    "A phone number."

    mc "Sure thing."

    "I fold the paper."

    stop music fadeout 1
    hide kirei with dissolve
    $ renpy.pause(1)
    play music "assets/music/FriendsForever.mp3"
    show tomo worry with dissolve

    t "So who was that, [protagchan]?" # The variable that stores his nickname. It’s the same as {protag} if the player uses a custom name, but "Aki" if they use the default.

    "I stand up to meet Tomo and sling my backpack around my shoulder, as we both walk out of the classroom on our way to the next period."
    
    play ambience "assets/sfx/hallway.mp3" fadein 3
    
    scene black
    with dissolve
    
    scene bg hallway
    show tomo worry
    with dissolve

    mc "You know that girl, Kirei?"
    
    stop ambience fadeout 15

    # Tomo cocks an eyebrow.

    t "What would Little Miss Popular want with you?"

    mc "Hey!"

    "I nudge Tomo with my elbow."

    mc "What {i}woudln’t{/i} a pretty girl like that want with me?"

    t "…"

    mc "…"
    mc "No idea. But she gave me her phone number."

    $ showphone()
    
    "I smile as I type it into my phone contacts."
    
    $ hidephone()
    
    t "I don’t know about this, [protagchan]."

    mc "What’s not to get? A girl gave me her phone number."
    
    t "Isn’t that a little...{w=.5} y’know,{w=.5} odd?" # pauses the text for a moment.

    "I’d take offense to that if she wasn’t entirely right."
    "But who knows? It could be my lucky day."

    t "I mean…"

    t "Yeah, she seems nice… but what do you think she’s after?"

    mc "She said she’s interested in the recent vampire sightings."
    mc "Unlike {i}some{/i} people I know…"

    "Tomo sighs and looks away."

    t "Just{w=.5} watch your back, okay? What if {i}she’s{/i} a vampire?"

    mc "Right, and I’m the Pope."

    t "Hey now, you never know."
    t "She's only been here for a year. How do you think she could she have become so popular so fast?"
    
    mc "By not having a super-abrasive personality?"
    
    t "Hey!"

    show tomo happy with dissolve
    
    "Tomo giggles a bit."
    
    mc "Hell, if I ever met a vampire that pretty, maybe I wouldn’t mind her taking a bite out of me."
    
    show tomo worry with dissolve

    "Tomo rolls her eyes and sighs."

    t "Typical."

    "I smirk."
    "Tomo hates it when I talk about girls."

    t "Do you even know what it's like to be bitten?"

    mc "I haven’t met a vampire, so no."

    t "I meant in general, dummy."

    mc "Still a 'no'. Why, do you want to bite me?"

    show tomo happy with dissolve

    t "Don’t tempt me."

    t "So, I’m guessing we’re not hanging out after class today?"

    mc "I’m not sure."

    show tomo worry with dissolve

    mc "I mean, Kirei just gave me her number."

    mc "Maybe it won’t be such a big deal, though."

    mc "I’ll see what she wants, and then call you to let you know if I’m free."

    t "…"

    "She doesn’t look too thrilled."

    mc "Hey now, we’ll hang out tomorrow."
    mc "Promise."
    
    show tomo happy with dissolve

    t "We’d better."

    stop music fadeout 1
    show bg blank
    hide tomo
    with dissolve
    
    $ renpy.pause(1)
    play music "assets/music/HangingOut.mp3" fadein 0.5
    show bg classroom with dissolve

    "Ah. there we are."

    $ showphone()

    "I’ll just send Kirei a text."

    "I scroll through my contacts."

    "It doesn’t take long. I only have four people in my phone."

    # grab blocky font for texting and apply it to this conversation.

    mcPhone "hey where do you want to meet"
    
    $ hidephone()

    "I pack up my belongings."

    "Suddenly, I’m feeling a bit of panic."

    "What if this is all some sort of sick joke?"
    "What if she{nw}"

    $ ringphone()
    $ showphone()

    kPhone "meet you at the corner near the bookstore" # trying to think of a way to make life easier for Tim. Generic street vs outside the school.
    
    $ hidephone()

    "Well, I guess I’ve already dug myself a hole."

    "My reputation can’t possibly get any worse."

    "Despite what Tomo had to say,{w=.5} I’m going along with this."
    
    stop music fadeout 1
    
    show bg blank with dissolve
    
    $ renpy.pause()
    
    jump day1_afterschool
    
label day1_afterschool:
    
    
    
    
    return